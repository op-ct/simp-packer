---
version: 5

defaults:
  datadir: "data"

hierarchy:
  - name: "YAML backend"
    data_hash: yaml_data
    paths:
      #- "node/%{trusted.certname}.yaml"
      #- "box/%{::box}/os/%{facts.os.name}/%{facts.os.release.major}.yaml"
      #- "box/%{::box}/os/%{facts.os.name}.yaml"
      - "box/%{::box}/build_type/%{::build_type}.yaml"
      - "box/%{::box}/template_key/%{::template_key}.yaml"
      - "box/%{::box}.yaml"
      #- "os/%{facts.os.name}/%{facts.os.release.major}.yaml"
      #- "os/%{facts.os.name}.yaml"
      - "build_type/%{::build_type}.yaml"
      - "template_key/%{::template_key}.yaml"
      - "common.yaml"
#  - name: "JSON backend"
#    data_hash: json_data
#    paths:
#      - "node/%{trusted.certname}.json"
#      - "box/%{::box}/os/%{facts.os.name}/%{facts.os.release.major}.json"
#      - "box/%{::box}/os/%{facts.os.name}.json"
#      - "box/%{::box}/%{::build_type}.json"
#      - "box/%{::box}/%{::template_key}.json"
#      - "box/%{::box}.json"
#      - "os/%{facts.os.name}/%{facts.os.release.major}.json"
#      - "os/%{facts.os.name}.json"
#      - "%{::build_type}.json"
#      - "%{::template_key}.json"
#      - "common.json"
#  - name: "HOCON backend"
#    data_hash: hocon_data
#    paths:
#      - "node/%{trusted.certname}.hocon"
#      - "box/%{::box}/os/%{facts.os.name}/%{facts.os.release.major}.hocon"
#      - "box/%{::box}/os/%{facts.os.name}.hocon"
#      - "box/%{::box}/%{::build_type}.hocon"
#      - "box/%{::box}/%{::template_key}.hocon"
#      - "box/%{::box}.hocon"
#      - "os/%{facts.os.name}/%{facts.os.release.major}.hocon"
#      - "os/%{facts.os.name}.hocon"
#      - "%{::build_type}.hocon"
#      - "%{::template_key}.hocon"
#      - "common.hocon"

# box:
#    Box Role from roadmap
#    e.g., `simp-server`, `simp-client`, `linux-min`, `simp-server-preconfig`
#
# build_type:
#    - simp_iso_to_vagrant_box
#
# template_key:
#
plan_hierarchy:
  - name: "Nested YAML Lookups"
    lookup_key: 'nested_lookup::yaml_key'
    paths:
      - "box/%{box}/build_type/%{build_type}.nested.yaml"
      - "box/%{box}/template_key/%{template_key}.nested.yaml"
      - "box/%{box}.nested.yaml"
      - "plan_common.nested.yaml"
    options:
      hiera_interpolation: true
  - name: "YAML backend"
    data_hash: yaml_data
    paths:
      - "box/%{box}/build_type/%{build_type}.yaml"
      - "box/%{box}/template_key/%{template_key}.yaml"
      - "box/%{box}.yaml"
      - "plan_common.yaml"
      - "common.yaml"
#  - name: "JSON backend"
#    data_hash: json_data
#      - "plan_common.json"
#      - "common.json"
#    paths:
#  - name: "HOCON backend"
#    data_hash: hocon_data
#    paths:
#      - "plan_common.hocon"
#      - "common.hocon"
